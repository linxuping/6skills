function validateForm(){return $("#auth-form").validate({rules:{phone:{required:!0,digits:!0,rangelength:[11,11]},code:{required:!0}},messages:{phone:{required:"请输入正确的手机号码",digits:"",rangelength:"11位手机号码"},code:{required:"请输入验证码"}},submitHandler:function(e){$(e).find(":submit").attr("disabled",!0),$(e).ajaxSubmit({dataType:"json",data:{openid:geopenid()},success:function(e){e="object"==typeof e?e:JSON.parse(e),0===e.errcode?ReactDOM.render(React.createElement(AlertDialog,{title:"验证成功",msg:"恭喜您验证成功！",callback:function(){if(prostr=sessionStorage.getItem("_profile"),null==prostr)alert("从服务器获取用户信息失败.");else{var e=JSON.parse(prostr);e.phone=$("#phone").val(),sessionStorage.setItem("_profile",JSON.stringify(e)),history.back()}}}),document.getElementById("alert-wrap")):(ReactDOM.render(React.createElement(AlertDialog,{title:"提示",msg:"验证失败："+e.errmsg}),document.getElementById("alert-wrap")),code.value="")},error:function(e,t){ReactDOM.render(React.createElement(AlertDialog,{title:"提示",msg:"服务出错，请稍后重试！"}),document.getElementById("alert-wrap"))},complete:function(){$(e).find(":submit").attr("disabled",!1)}})}})}var Verify=React.createClass({displayName:"Verify",verifyHandler:function(e){if(!this.state.validateForm.element($("#phone")))return $("#phone").focus(),!1;var t=$(e.target);return!t.hasClass("weui_btn_disabled")&&void $.ajax({url:ges("get-auth-code"),type:"get",dataType:"json",data:{openid:geopenid(),phone:$("#phone").val()}}).done(function(e){console.log("success"),t.addClass("weui_btn_disabled weui_btn_default").removeClass("weui_btn_plain_primary"),this.countDown(t,60)}.bind(this)).fail(function(){ReactDOM.render(React.createElement(AlertDialog,{title:"提示",msg:"服务出错，请稍后重试！"}),document.getElementById("alert-wrap"))})},countDown:function(e,t){t>0?(e.text(t+"s重新发送"),setTimeout(function(){this.countDown(e,t-1)}.bind(this),1e3)):e.text("获取验证码").addClass("weui_btn_plain_primary").removeClass("weui_btn_disabled weui_btn_default")},componentDidMount:function(){this.setState({validateForm:validateForm()})},render:function(){var e=ges("wxauth");return React.createElement("div",{className:"verify"},React.createElement("div",{className:"weui_cells_title"},"验证手机号"),React.createElement("form",{action:e,method:"post",id:"auth-form"},React.createElement("div",{className:"weui_cells weui_cells_form"},React.createElement("div",{className:"weui_cell"},React.createElement("div",{className:"weui_cell_hd"},React.createElement("label",{className:"weui_label"},"手机号")),React.createElement("div",{className:"weui_cell_bd weui_cell_primary"},React.createElement("input",{type:"number",name:"phone",id:"phone",className:"weui_input",pattern:"[0-9*]"}))),React.createElement("div",{className:"weui_cell weui_cell_vcode"},React.createElement("div",{className:"weui_cell_hd"},React.createElement("label",{htmlFor:"code",className:"weui_label"},"验证码")),React.createElement("div",{className:"weui_cell_bd weui_cell_primary"},React.createElement("input",{type:"text",name:"code",id:"code",className:"weui_input"})),React.createElement("div",{className:"weui_cell_hd",style:{marginBottom:"-10px",marginRight:"0px"}},React.createElement("a",{href:"#",onClick:this.verifyHandler,className:"weui_btn weui_btn_mini weui_btn_plain_primary"},"获取验证码")))),React.createElement("div",{className:"weui_cells_tips"}),React.createElement("div",{className:"weui_btn_area"},React.createElement("button",{type:"submit",className:"weui_btn weui_btn_primary"},"提交"))),React.createElement("div",{id:"alert-wrap"}))}}),AlertDialog=React.createClass({displayName:"AlertDialog",confirmHandler:function(){this.props.callback?this.props.callback():React.unmountComponentAtNode(document.getElementById("alert-wrap"))},render:function(){return React.createElement("div",{className:"weui_dialog_alert",id:"alert",ref:"alert"},React.createElement("div",{className:"weui_mask"}),React.createElement("div",{className:"weui_dialog"},React.createElement("div",{className:"weui_dialog_hd"},React.createElement("strong",{className:"weui_dialog_title"},this.props.title&&"提示")),React.createElement("div",{className:"weui_dialog_bd"},this.props.msg),React.createElement("div",{className:"weui_dialog_ft"},React.createElement("a",{href:"javascript:;",className:"weui_btn_dialog primary",onClick:this.confirmHandler},"确定"))))}});